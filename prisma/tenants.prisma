// ==============================
// BETTER-AUTH ORGANIZATIONS
// ==============================

model Organization {
  id       String  @id @default(uuid())
  name     String
  slug     String  @unique // antifocus
  logo     String?
  metadata Json?

  // additionals
  status   OrganizationStatus @default(pending)
  settings Json? // configs

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // soft delete
  deletedAt DateTime?

  organizationRoles OrganizationRole[]
  members           Member[]
  invitations       Invitation[]
  activityLogs      ActivityLog[]

  @@index([slug])
  @@index([name])
  @@index([status])
  @@map("organizations")
}

// ==============================
// BETTER-AUTH ORGANIZATION ROLES
// ==============================

model OrganizationRole {
  id             String @id @default(uuid())
  organizationId String

  role       String
  permission Json

  // additionals
  isSystem Boolean @default(false) // system_role
  enabled  Boolean @default(true)
  position Int?

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([organizationId])
  @@index([role])
  @@index([enabled])
  @@map("org_roles")
}

// ==============================
// BETTER-AUTH MEMBERS
// ==============================

model Member {
  id             String @id @default(uuid())
  organizationId String
  userId         String

  role String @default("member")

  // additionals
  enabled  Boolean @default(true)
  metadata Json?

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([organizationId])
  @@index([userId])
  @@index([enabled])
  @@map("members")
}

// ==============================
// BETTER-AUTH INVITATIONS
// ==============================

model Invitation {
  id             String @id @default(uuid())
  organizationId String
  inviterId      String

  email     String
  role      String           @default("member")
  status    InvitationStatus @default(pending)
  expiresAt DateTime

  // additionals
  metadata Json?

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [inviterId], references: [id], onDelete: Cascade)

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("invitations")
}
