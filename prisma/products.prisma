// ==============================
// PRODUCTS
// ==============================

model Product {
  id             String @id @default(uuid())
  organizationId String

  name        String
  slug        String  @unique
  description String?

  basePrice Decimal @db.Decimal(19, 4)
  currency  String  @default("IDR")

  weight     Int?
  dimensions Json?

  status ProductStatus @default(draft)

  attributes Json?
  metadata   Json?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  productMedias     ProductMedia[]
  productVariants   ProductVariant[]
  productCategories ProductCategory[]
  orderItems        OrderItem[]

  @@index([organizationId])
  @@index([slug])
  @@index([status])
  @@map("products")
}

// ==============================
// PRODUCT VARIANTS
// ==============================

model ProductVariant {
  id        String @id @default(uuid())
  productId String

  name String
  sku  String? @unique

  price Decimal @db.Decimal(19, 4)

  stock Int @default(0)

  weight     Int?
  dimensions Json?

  enabled  Boolean @default(true)
  position Int     @default(0)

  attributes Json?
  metadata   Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  productVariantMedias ProductVariantMedia[]
  orderItems           OrderItem[]

  @@index([productId])
  @@index([sku])
  @@index([enabled])
  @@map("product_variants")
}
